\subsubsection{Преэнкодер}

Преэнкодер представляет собой сверточную нейронную сеть, состоящую из трех слоев \textit{Convolution2D} с ядрами размером 3x3 и количеством фильтров, равным 8, 16 и 32 соответственно. В качестве активации используется \textit{ReLU}. Полная архитектура приведена в таблице \ref{pre-encoder-arch}. Данный модуль принимает в качестве входных данных не обработанное 4-канальное изображение GRGB RAW (до дебайеризации) размерности $H/2\times W/2\times 4$ и производит 32-канальный вывод размерности $H/2\times W/2\times 32$, который подается в общую AW-Net.

\begin{table}[H]
    \caption{Архитектура преэнкодера}\label{pre-encoder-arch}
    \begin{tabular}{|p{5cm}|p{3cm}|p{3cm}|}
        \hline
        {Слой} & {Ядро} & {Число фильтров} \\
        \hline
        Convolution2D & 3 & 8 \\
        \hline
        ReLU & - & - \\
        \hline
        Convolution2D & 3 & 16 \\
        \hline
        ReLU & - & - \\
        \hline
        Convolution2D & 3 & 32 \\
        \hline
        ReLU & - & - \\
        \hline
    \end{tabular}
\end{table}

Применение автоэнкодеров обусловлено огромным разрывом между различными устройствами в веду их уникальности. Цель преэнкодера заключается в уменьшении доменного разрыва между разными камерами путем извлечения индивидуальных и независимых признаков из каждой камеры. Иными словами, преэнкодер необходим для учета индивидуальных особенностей сенсора, таких как black level, индивидуальные шумы и т.д.

Во время доменной адаптации преэнкодеры обучаются независимо и подключаются напрямую к обучаемой нейронной сети, обучаясь вместе с основной моделью как единое целое.