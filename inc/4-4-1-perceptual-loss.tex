\subsubsection{Функция потерь восприятия}

Функция потерь восприятия (Perceptual loss), также известная как VGG loss -- это функция потерь, которая использует предобученную на крупномосшабном наборе данных сверточную нейронную сеть, такую как VGG-16 или VGG-19, для оценки качества генерируемых изображений. Она основывается на предположении, что высокоуровневые признаки, извлекаемые из изображений нейронной сетью, лучше коррелируют с восприятием человеком, чем низкоуровневые признаки, такие как средние значения пикселей или сумма квадратов разностей между пикселями, так как подразумевается что предобученная на большом обемеданных нейронная сеть обладает хорошей обобщающей способностью.

Эта функция потерь определяется как сумма средних квадратичных отклонений между выходами сверточной сети на исходном и сгенерированном изображениях:

\begin{equation}
    \label{eq:2-1-3-1}
    L^{vgg} = L_{2}(VGG(I)-VGG(\hat{I})),
\end{equation}

где $VGG$ -- вывод последнего сверточного слоя VGG.

Функция потерь может быть применена к разным слоям сверточной сети, в зависимости от того, насколько высокоуровневые признаки нужно учитывать при оценке качества изображений (рис. \ref{vgg-loss}). 

\addimghere{2-1-vgg-loss}{0.6}{Визуализация скрытых представлений функции потерь восприятия.}{vgg-loss}

Перцептуальная функция часто используется в генеративных моделях, таких как генеративно-состязательные сети (GAN), чтобы улучшить качество генерируемых изображений и сделать их более реалистичными. Она также может быть использована в других задачах компьютерного зрения, таких как восстановление изображений, суперразрешение, стилизация изображений и т.д.