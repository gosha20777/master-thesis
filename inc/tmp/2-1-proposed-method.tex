\subsection{Предлагаемый подход}\label{sect-2-1}

Настоящим представляется конвейер обработки изображений на основе AW-Net, а также описывается метод применения доменной адаптации к данному конвейеру. Схема нейросетевой архитектуры данного конвейера представлена на рисунке \ref{main-arch}. Учитывая, что выходным результатом является RGB-изображение, а входным - RAW-изображение, данная нейросеть должна научиться учитывать специфические особенности аппаратного обеспечения камеры в дополнение к изучению встроенного в устройство ISP конвейера.

\addimghere{2-1-main-arch}{0.9}{Схема нейросетевой архитектуры.}{main-arch}

Стоит отметить, что разрыв домена имеет место, поскольку модель, разработанная с использованием данных с одной камеры (исходный домен), не работает аналогичным образом при применении к данным с другой камеры (целевой домен) в силу уникальных особенностей каждого устройства. Особенности сенсоров и ISP конвейера обычно различаются, при этом ISP является проприетарным программным обеспечением, что делает его реверс-инжиниринг практически невозможным. Для решения данных ограничений, предлагается метод адаптации домена, позволяющий обучить конвейер обработки на небольшом наборе данных для получения выходных результатов в целевом домене.

\addimghere{2-1-main-arch-da}{0.9}{Иллюстрация предлагаемого подхода к обучению ISP-конвейеров с этапами предобучения и адаптации домена.}{main-arch-da}

В дальнейшем, исходный набор данных обозначается как достаточно большой для обучения нейросетевого конвейера с хорошим качеством, а набор данных для целевого домена считается небольшим (около 10 изображений). Цель данного исследования заключается в адаптации нейронного ISP конвейера, обученного на исходном домене, к целевому домену без заметной потери качества. Для достижения этой цели, модель обучается генерировать изображения RGB с использованием как исходного, так и целевого доменов в качестве входных данных. Описываемый метод проиллюстрирован на рисунке \ref{main-arch-da}. Это сквозная обучаемая глубокая сеть, которая принимает изображение RAW в качестве входных данных и выполняет реконструкцию изображения, используя малый набор помеченных данных для адаптации исходного домена к целевому.

\input{inc/2-1-1-nodel-arch} % Архитектура конвейера
\input{inc/2-1-2-training-process} % Алгоритм обучения
\input{inc/2-1-3-losses} % Losses