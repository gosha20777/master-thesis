\subsubsection{Алгоритм обучения}\label{sect-2-1-2}

Для того чтобы обеспечить успешную доменную адаптацию конвейера обработки изображений, предлагаетсяпровести обучение сети в несколько этапов, которые помогут добиться наилучших результатов.

\begin{enumerate}
    \item Первый этап заключается в предварительном обучении конвейера в исходном домене. На данном этапе используется только прекодер исходного домена и выход RGB AW-Net. При этом выходы классификатора домена не учитываются, а преэнкодер целевого домена не используется. При выполнении данного этапа конвейер обработки изображений обучается на большом наборе данных как если бы это был end-2-end конвейер без доменной адаптации.
    \item Второй этап заключается в инициализации целевого преэнкодера весами из исходного преэнкодера. Это позволяет начать обучение сети на основе уже настроенных параметров, что может значительно ускорить процесс обучения.
    \item Третий этап представляет собой этап адаптации домена, где производится обучение всй сети, используя весь исходный домен и небольшую часть целевого домена (10 изображений). На этом этапе на каждом шаге обучения производится последовательная подача оответвующих пар изображений RAW-RGB из целевого и исходного доменов в соответствующий преэнкодер и вычисляются соответствующие функции потерь. При этом учитываются предсказания классификатора предметной области и его обратный градиент.
\end{enumerate}

Такой подход позволяет обеспечить эффективную адаптацию домена, учитывая индивидуальные особенности каждого домена и выделяя доменно-инвариатные признаки. Кроме того, предварительное обучение и инициализация целевого преэнкодера позволяют снизить вычислительную сложность и ускорить процесс обучения а также значительно сократить число размеченных данных, что является важным преимуществом данного подхода. Стоит также отметить, как показано в эксериментах, что используя предлагаемый подход, удается достичь сопоставимого с конвейором обученным с нуля на полном наборе данных качества формирования изображений.

